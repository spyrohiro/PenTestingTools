#!/bin/bash

# Run ./script.sh -v list.txt for virtualhostenum, -r for recordenumeration, -z for zone enumeration.
# If using recordenumerator, set -type=MX, PTR, etc., and set -ip=(target) and -domain=(domain.com) for all flags.

# Variables
ip=""
domain=""
type=""

# command-line argument cases
while [[ $# -gt 0 ]]; do
    case $1 in
        -ip)
            ip="$2"
            shift 2
            ;;
        -domain)
            domain="$2"
            shift 2
            ;;
        -type)
            type="$2"
            shift 2
            ;;
        -v|-r|-z)
            flag="$1"
            shift
            ;;
        *)
            word_list="$1"  
            shift
            ;;
    esac
done

# Check if flag is there
if [ -z "$flag" ] && [ -z "$domain" ] && [ -z "$ip" ] && [ -z "$type" ]; then
    echo "Usage: $0 <flag> <word_list_file> <ip> <domain> <type>"
    echo "Flags:"
    echo "  -v    Virtual Host Enumeration"
    echo "  -r    Record Enumeration"
    echo "  -z    Zone Enumeration"
    echo "  -ip   Sets IP"
    echo "  -domain    Sets Domain"
    echo "  -type    Sets type only use for -r flag"
    exit 1
fi

# Check if word list file is there
if [ -z "$word_list" ]; then
    echo "Word list file is missing."
    exit 1
fi

# Check the flag and execute corresponding functionality
if [ "$flag" = "-v" ]; then
    # Virtual Host Enumeration
    while IFS= read -r word; do
        echo "********"
        echo "FUZZING: $word"
        echo "********"
        curl -s "http://${ip}" -H "Host: $word.${domain}" #Change the domain and the IP address 
        echo
    done < "$word_list"
elif [ "$flag" = "-r" ]; then
    # Record Enumeration
    while IFS= read -r nameserver; do
        nslookup -type=${type} "${nameserver}.${domain}" ${ip} 
    done < "$word_list"
elif [ "$flag" = "-z" ]; then
    # Zone Enumeration
    while IFS= read -r NAMESERVER; do
        nslookup -type=any -query=AXFR "${NAMESERVER}.${domain}" ${ip} #Change this to the IP of the target.
    done < "$word_list"
fi

exit 0
